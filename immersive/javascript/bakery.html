<html>
<head>
  <title>Bakery Bonanza</title>
  <style type="text/css">
  #bakery .display div { width: 200px; height: 200px; float: left; }
  #bakery .display .cupcake { background: url("http://i.imgur.com/9ix2JRZ.jpg"); }
  #bakery .display .cookie { background: url("http://i.imgur.com/Yxq78qn.jpg"); }
  </style>
</head>
<body>

<div id="bakery">
  <button class="make" data-good-type="cupcake">Make Cupcake</button>
  <button class="make" data-good-type="cookie">Make Cookie</button>
  <h4>Available Ingredients:</h4>
  <ul class="ingredients"></ul>
  <h3>Food Display Case</h3>
  <div class="display"></div>
</div>


<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script type="text/javascript">

function capitalize(string) {
  return string.charAt(0).toUpperCase() + string.substr(1).toLowerCase();
};

var bakery = {
  supplies: {
    flour: 30,
    eggs: 12,
    sugar: 17,
    spice: 16,
    chocolate: 18,
    salt: 13,
    butter: 11,
    nuts: 32,
    nutella: 14
  },
  goodRequirements: {
    cupcake: {
      flour: 2,
      eggs: 1,
      sugar: 1, 
      butter: 1,
      nuts: 3,
      nutella: 1
    },
    // TODO: Create required ingredients for cookie
    cookie: {
      flour: 1,
      eggs: 1,
      sugar: 2,
      butter: 1,
      chocolate: 2,
      salt: 0.5
    }
  },
  make: function (goodType) {
    console.log('Attempting to make a:', goodType);
    var req = this.goodRequirements[goodType];

    // TODO: Only make if we have enough ingredients
    for (var i in req) {
      if (this.supplies[i] >= req[i]) {
        this.supplies[i] -= req[i];
        this.updateIngredientsList();
      }
      else {
        alert("We can't do this " + goodType + ", because we are out of " + i);
      }
    };
    console.log('The bakery made a ' + goodType + '!');

    // TODO: Add class goodType class to div
    var goodDiv = $('<div>').addClass(goodType);
    $('#bakery .display').append(goodDiv);
    console.log(this.supplies);
  },
  updateIngredientsList: function () {
    for (ingredient in this.supplies) {
      $('.ingredients .' + ingredient + ' span').text(this.supplies[ingredient]);
    }
  },
  setIngredientsList: function () {
    for (ingredient in this.supplies) {
      $('.ingredients').append('<li class="' + ingredient + '">' + capitalize(ingredient) + 
        ": <span>" + this.supplies[ingredient] + "</span></li>");
    }
  }
};

$('#bakery .make').on('click', function (e) {
  var goodType = $(e.currentTarget).data('good-type');
  // TODO: Make the good
  bakery.make(goodType);
});

bakery.setIngredientsList();

</script>
</body>
</html>